# Copyright (c) Microsoft Corporation. All rights reserved.
# Licensed under the MIT License.
pool:
    vmImage: 'ubuntu-16.04'

steps:
    - task: NodeTool@0
      inputs:
          versionSpec: '10.15.3'
      displayName: use node 10.15.3

    - script: yarn install --frozen-lockfile
      workingDirectory: $(Build.SourcesDirectory)/typescript-selenium-webdriver
      displayName: yarn install

    - script: yarn test --ci
      workingDirectory: $(Build.SourcesDirectory)/typescript-selenium-webdriver
      displayName: yarn test

    - task: PublishTestResults@2
      inputs:
          testResultsFiles: $(Build.SourcesDirectory)/typescript-selenium-webdriver/test-results/junit.xml
          testRunTitle: typescript-selenium-webdriver
      condition: always()
      displayName: publish test results

    - task: PublishCodeCoverageResults@1
      inputs:
          codeCoverageTool: Cobertura
          summaryFileLocation: $(Build.SourcesDirectory)/typescript-selenium-webdriver/test-results/coverage/cobertura-coverage.xml
          failIfCoverageEmpty: true
      displayName: publish code coverage
